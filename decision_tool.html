<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChurnScope | Decision Tool</title>

  <link rel="stylesheet" href="style.css" />

  <style>
    /* Page uses your editorial theme; these are only tool-specific components */
    .tool-header { margin-top: 1.25rem; }

    .tool-layout{
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.25rem;
      margin-top: 1.25rem;
    }
    @media (min-width: 980px){
      .tool-layout{
        grid-template-columns: 0.95fr 1.05fr;
        align-items: start;
      }
    }

    .panel{
      background: rgba(242,240,239,0.85);
      border: 1px solid rgba(17,17,17,0.10);
      border-radius: 16px;
      padding: 1.25rem;
    }

    .panel h3{
      margin-bottom: 0.8rem;
      font-size: 1.05rem;
      letter-spacing: -0.01em;
      color: var(--text);
    }

    .hint{
      font-size: 0.92rem;
      color: var(--muted);
      line-height: 1.45;
      max-width: 80ch;
    }

    .mono{
      font-variant-numeric: tabular-nums;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }

    .form-grid{ display: grid; gap: 0.9rem; }
    .field{ display: grid; gap: 0.35rem; }
    .field label{
      font-size: 0.92rem;
      color: rgba(17,17,17,0.80);
      font-weight: 600;
    }
    .field input[type="number"],
    .field input[type="text"]{
      width: 100%;
      padding: 0.65rem 0.7rem;
      border-radius: 12px;
      border: 1px solid rgba(17,17,17,0.14);
      background: rgba(255,255,255,0.75);
      outline: none;
    }
    .field input[type="range"]{ width: 100%; }

    .badge{
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      font-size: 0.84rem;
      border: 1px solid rgba(17,17,17,0.10);
      background: rgba(255,255,255,0.70);
      color: rgba(17,17,17,0.75);
    }

    .actions{
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-top: 0.85rem;
      align-items: baseline;
    }

    .linklike{
      display: inline-block;
      text-decoration: none;
      color: var(--accent);
      border-bottom: 1px solid rgba(45,104,196,0.35);
      padding-bottom: 2px;
      font-weight: 700;
    }
    .linklike:hover{ border-bottom-color: rgba(45,104,196,0.80); }

    .presets{
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.75rem;
    }
    .chip{
      display: inline-flex;
      align-items: center;
      border: 1px solid rgba(17,17,17,0.12);
      background: rgba(255,255,255,0.65);
      border-radius: 999px;
      padding: 0.35rem 0.7rem;
      font-size: 0.88rem;
      font-weight: 700;
      cursor: pointer;
      user-select: none;
    }
    .chip:hover{ border-color: rgba(45,104,196,0.35); background: rgba(255,255,255,0.85); }

    .kpi-grid{
      display: grid;
      gap: 0.75rem;
      grid-template-columns: 1fr 1fr;
    }
    @media (min-width: 540px){
      .kpi-grid{ grid-template-columns: 1fr 1fr 1fr 1fr; }
    }

    .kpi{
      padding: 0.9rem;
      border-radius: 14px;
      border: 1px solid rgba(17,17,17,0.10);
      background: rgba(255,255,255,0.70);
    }
    .kpi .label{
      font-size: 0.85rem;
      color: rgba(17,17,17,0.68);
      margin-bottom: 0.25rem;
      font-weight: 700;
    }
    .kpi .value{
      font-size: 1.1rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      color: var(--text);
    }

    .summary{
      display: grid;
      gap: 0.7rem;
      margin-top: 0.9rem;
      padding-top: 0.9rem;
      border-top: 1px solid rgba(17,17,17,0.10);
    }
    .summary strong{ color: var(--text); }
    .summary-line{ color: var(--muted); }

    .chart-wrap{
      margin-top: 1rem;
      padding: 0.9rem;
      border-radius: 14px;
      border: 1px solid rgba(17,17,17,0.10);
      background: rgba(255,255,255,0.70);
    }
    canvas{ width: 100%; height: 220px; display: block; }

    .table-wrap{
      margin-top: 1rem;
      overflow: auto;
      border-radius: 14px;
      border: 1px solid rgba(17,17,17,0.10);
      background: rgba(255,255,255,0.70);
    }
    table{
      width: 100%;
      border-collapse: collapse;
      min-width: 560px;
    }
    th, td{
      padding: 0.7rem 0.8rem;
      border-bottom: 1px solid rgba(17,17,17,0.06);
      text-align: left;
      font-size: 0.92rem;
      color: var(--text);
    }
    th{
      font-weight: 800;
      background: rgba(255,255,255,0.8);
      position: sticky;
      top: 0;
    }

    .callout{
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(17,17,17,0.10);
    }

    /* Slightly more spaced nav on this page */
    header.site-header .site-nav { gap: 1.35rem; }
  </style>
</head>

<body>
  <!-- Use same header classes as your home page so Karrik + spacing match -->
  <header class="site-header container tool-header">
    <h1>ChurnScope</h1>
    <p class="subtitle">Capacity-based retention targeting • business-focused decision support</p>

    <nav class="site-nav" aria-label="Primary">
      <a href="index.html">Home</a>
      <a href="#tool">Decision</a>
      <a href="#about">Method</a>
    </nav>
  </header>

  <main class="container" id="tool">
    <section class="section">
      <div class="section-head">
        <h2>Decision Tool</h2>
        <div class="section-note">
          <span class="badge" id="dataCountBadge">Loading data…</span>
        </div>
      </div>

      <p class="hint">
        This tool answers a business question: <strong>“Given limited outreach capacity, who should we contact to reduce churn, and is it worth it?”</strong>
        It ranks customers by churn risk, simulates outreach, and estimates incremental ROI based on your assumptions.
      </p>

      <div class="tool-layout">
        <!-- LEFT: Inputs -->
        <div class="panel" aria-label="Inputs panel">
          <h3>Inputs</h3>

          <div class="form-grid">
            <div class="field">
              <label for="maxContacts">Outreach capacity (max customers contacted)</label>
              <input id="maxContacts" type="range" min="100" max="5000" step="100" value="1000" />
              <div class="hint">
                Selected: <span class="mono" id="maxContactsLabel">1000</span>
              </div>
            </div>

            <div class="field">
              <label for="contactCost">Contact cost ($ per customer)</label>
              <input id="contactCost" type="number" min="0" step="1" value="20" />
              <div class="hint">Examples: call center time, discount offer cost, outreach ops cost.</div>
            </div>

            <div class="field">
              <label for="churnLoss">Churn loss ($ value at risk)</label>
              <input id="churnLoss" type="number" min="0" step="10" value="200" />
              <div class="hint">Think: expected revenue / LTV lost if the customer churns.</div>
            </div>

            <div class="field">
              <label for="saveRate">Save rate (campaign effectiveness, 0–1)</label>
              <input id="saveRate" type="number" min="0" max="1" step="0.01" value="0.25" />
              <div class="hint">If you contact a true churner, what fraction will be retained?</div>
            </div>
          </div>

          <div class="presets" aria-label="Scenario presets">
            <button class="chip" id="presetSaaS" type="button">Preset: SaaS email</button>
            <button class="chip" id="presetTelecom" type="button">Preset: Telecom call</button>
            <button class="chip" id="presetBank" type="button">Preset: Bank retention</button>
          </div>

          <div class="actions">
            <a class="linklike" href="#" id="downloadBtn">Download contact list (CSV)</a>
            <a class="linklike" href="data/churn_scores.csv" target="_blank" rel="noopener">View scored data</a>
          </div>

          <div class="callout">
            <p class="hint">
              Profit model (incremental):
              <span class="mono">profit = expected_TP × (save_rate × churn_loss) − contacts × contact_cost</span>.
              If your CSV includes <span class="mono">actual_churn</span>, the tool also reports estimated precision/recall.
            </p>
          </div>
        </div>

        <!-- RIGHT: Outputs -->
        <div class="panel" aria-label="Outputs panel">
          <h3>Business Summary</h3>

          <div class="kpi-grid" aria-label="Key metrics">
            <div class="kpi">
              <div class="label">Estimated profit</div>
              <div class="value mono" id="profitValue">—</div>
            </div>
            <div class="kpi">
              <div class="label">Total outreach cost</div>
              <div class="value mono" id="costValue">—</div>
            </div>
            <div class="kpi">
              <div class="label">ROI (profit / cost)</div>
              <div class="value mono" id="roiValue">—</div>
            </div>
            <div class="kpi">
              <div class="label">Break-even save rate</div>
              <div class="value mono" id="breakevenValue">—</div>
            </div>
          </div>

          <div class="summary" aria-label="Executive summary">
            <div class="summary-line" id="execSummary">—</div>
            <div class="summary-line" id="execSummary2">—</div>
            <div class="summary-line hint" id="execCaveat">—</div>
          </div>

          <div class="chart-wrap" aria-label="Capacity profit chart">
            <div class="hint" style="margin-bottom:0.6rem;">
              Capacity → profit (model ranking) on this scored dataset
            </div>
            <canvas id="profitChart" width="900" height="260"></canvas>
          </div>

          <div class="table-wrap" aria-label="Strategy comparison">
            <table>
              <thead>
                <tr>
                  <th>Strategy</th>
                  <th>Contacts</th>
                  <th>Expected TP</th>
                  <th>Estimated profit</th>
                </tr>
              </thead>
              <tbody id="compareTbody">
                <tr><td colspan="4">Loading…</td></tr>
              </tbody>
            </table>
          </div>

          <div class="table-wrap" aria-label="Top targets preview">
            <table>
              <thead>
                <tr>
                  <th>Customer</th>
                  <th>Churn probability</th>
                  <th>Contact?</th>
                  <th>Actual churn</th>
                </tr>
              </thead>
              <tbody id="targetsTbody">
                <tr><td colspan="4">Loading…</td></tr>
              </tbody>
            </table>
          </div>

          <p class="hint" style="margin-top:0.8rem;">
            Preview shows top 25. Download exports the full top-N contact list.
          </p>

          <div class="callout">
            <h3 style="margin-bottom:0.55rem;">Interpretation</h3>
            <p class="hint" id="interpretation">—</p>
          </div>
        </div>
      </div>
    </section>

    <section id="about" class="section">
      <div class="section-head">
        <h2>Method</h2>
      </div>

      <p class="hint">
        ChurnScope is designed to be understandable in business terms: it links model scores to an actionable outreach policy under budget constraints.
      </p>

      <div class="tool-layout" style="margin-top:1rem;">
        <div class="panel">
          <h3>1) Scoring customers (offline)</h3>
          <p class="hint">
            A churn model is trained offline in Python on tabular customer features and used to generate a <span class="mono">churn_probability</span> score per customer.
            These scores are exported to a CSV, which keeps the website deployable on GitHub Pages (no server).
          </p>
        </div>

        <div class="panel">
          <h3>2) Turning scores into an outreach policy</h3>
          <p class="hint">
            Most retention teams can’t contact everyone. The tool uses <strong>capacity-based targeting</strong>:
            rank customers by churn risk and contact the top N customers, where N is your outreach capacity.
            This matches how real teams operate (call centers, success teams, campaigns with limited budget).
          </p>
        </div>

        <div class="panel">
          <h3>3) Measuring impact with unit economics</h3>
          <p class="hint">
            Accuracy alone doesn’t tell you whether an intervention is worth running. ChurnScope estimates incremental profit using:
            <span class="mono">profit = expected_TP × (save_rate × churn_loss) − contacts × contact_cost</span>.
            This reframes ML as a decision: “does outreach pay for itself under realistic assumptions?”
          </p>
        </div>

        <div class="panel">
          <h3>4) What a business user should take away</h3>
          <p class="hint">
            The goal is to identify an <strong>operating point</strong>: a capacity (or threshold) where ROI is maximized and the policy is practical.
            You can explore sensitivity to cost and effectiveness and export a prioritized target list.
          </p>
        </div>
      </div>

      <p class="hint" style="margin-top:1rem;">
        Implementation note: all policy math runs client-side in JavaScript using the scored CSV, making it easy to share and demo without infrastructure.
      </p>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© 2026 Ella Bourassa</p>
    </div>
  </footer>

  <script src="decision_tool.js"></script>
</body>
</html>
